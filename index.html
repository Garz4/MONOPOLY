<html>
	<head>
		<title>MONOPOLY</title>
		<link rel="stylesheet" href="style.css" />
	</head>

	<body style="font-family:Arial;">
		<center>
			<h1 class="titulo">MONOPOLY</h1>
			<h5 class="subtitulo">Clásico juego de mesa adaptado al entorno web, con la posibilidad de jugar contra una inteligencia artificial o contra otro ser humano en línea.</h5>
			<input type="text" placeholder="Introduce tu nick" id="nick"/>
			<button class="start-online" onclick="online()">Jugar en línea</button>
			<button class="start-offline" onclick="offline()">Jugar contra la IA</button><br/><br/>
			<div class="state" id="game-state"></div><br/>
			<table>
				<tr>
					<td>
						<center>
							<img src="jugador0.png" width="50" />
							<p id="player1-name">JUGADOR 1</p>
							<p id="player1-money">DINERO: 0 <span class="monopolymoney inline-block">&#8361;</span></p>
							<input type="button" class="comando" id="tirardados0" onclick="tirarDados()" value="Tirar dados" /><br />
							<input type="button" class="comando" id="comprarpropiedad0" onclick="comprarPropiedad()" value="Comprar propiedad" /><br />
							<input type="button" class="comando" id="pasar0" onclick="pasar()" value="Pasar" /><br />
							<hr />
							<div id="propiedadescolocar0"></div>
							<input type="button" class="comando" id="colocarcasa0" onclick="colocarCasa()" value="Colocar casa" /><br />
							<input type="button" class="comando" id="colocarhotel0" onclick="" value="Colocar hotel" /><br />
							<hr />
							<div id="propiedadesvender0"></div>
							<input type="button" class="comando" id="vendercasa0" onclick="" value="Vender casa" /><br />
							<input type="button" class="comando" id="venderhotel0" onclick="" value="Vender hotel" /><br />
							<hr />
							<div id="propiedadvender0"></div>
							<input type="button" class="comando" id="venderpropiedad0" onclick="venderPropiedad(0)" value="Vender propiedad" /><br />
							
						</center>
					</td>
					<td><!--PROPIEDADES PLAYER 1--></td>
					<td class="tablero"><canvas id="game" width="650" height="650"></canvas></td>
					<td><!--PROPIEDADES PLAYER 2--></td>
					<td>
						<center>
							<img src="jugador1.png" width="50" />
							<p id="player2-name">JUGADOR 2</p>
							<p id="player2-money">DINERO: 0 <span class="monopolymoney inline-block">&#8361;</span></p>
							<input type="button" class="comando" id="tirardados1" onclick="tirarDados()" value="Tirar dados" /><br />
							<input type="button" class="comando" id="comprarpropiedad1" onclick="comprarPropiedad()" value="Comprar propiedad" /><br />
							<input type="button" class="comando" id="pasar1" onclick="pasar()" value="Pasar" /><br />
							<hr />
							<div id="propiedadescolocar1"></div>
							<input type="button" class="comando" id="colocarcasa1" onclick="colocarCasa()" value="Colocar casa" /><br />
							<input type="button" class="comando" id="colocarhotel1" onclick="" value="Colocar hotel" /><br />
							<hr />
							<div id="propiedadesvender1"></div>
							<input type="button" class="comando" id="vendercasa1" onclick="" value="Vender casa" /><br />
							<input type="button" class="comando" id="venderhotel1" onclick="" value="Vender hotel" /><br />
							<hr />
							<div id="propiedadvender1"></div>
							<input type="button" class="comando" id="venderpropiedad1" onclick="venderPropiedad(1)" value="Vender propiedad" /><br />
						</center>
					</td>
				</tr>
			</table>
			<h5>ALUMNOS:<br/>
				<ul>
					<li>Uriel García Rivas</li>
					<li>Mike</li>
					<li>Mau</li>
					<li>Erika</li>
				</ul>
			</h5>
		</center>
	</body>
</html>

<!-- ==================== MAIN ====================== -->
<script type="text/javascript">
	var _FORTUNA_ = new Array();
	_FORTUNA_.push({texto:"Estreno de la gran ópera, recibiste $50 del jugador contrario.", op:"++", num:"50"});
	_FORTUNA_.push({texto:"Ingreso por tu seguro de vida, recibiste $100 del banco.", op:"+", num:"100"});
	_FORTUNA_.push({texto:"Por la venta de tus acciones recibiste $45 del banco.", op:"+", num:"45"});
	_FORTUNA_.push({texto:"Pagaste el recibo escolar, se te descontaron $150.", op:"-", num:"150"});
	_FORTUNA_.push({texto:"Pagaste al hospital $100.", op:"-", num:"100"});
	_FORTUNA_.push({texto:"Has ganado el segundo premio de un concurso, cobraste $10.", op:"+", num:"10"});
	_FORTUNA_.push({texto:"Avanzaste hasta la casilla de salida y cobraste $200.", op:"+++", num:"200"});
	_FORTUNA_.push({texto:"Quedas libre de la cárcel gratis.", op:"+", num:"no_carcel"});
	_FORTUNA_.push({texto:"Factura médica, pagaste $150.", op:"-", num:"150"});
	_FORTUNA_.push({texto:"Pagaste por servicios, se te descontaron $25.", op:"-", num:"25"});
	_FORTUNA_.push({texto:"Hacienda te devuelvió $20.", op:"+", num:"20"});
	_FORTUNA_.push({texto:"Ve a la cárcel directamente.", op:"-", num:"go_carcel"});
	_FORTUNA_.push({texto:"Ingreso por el fondo de navidades, cobraste $100.", op:"+", num:"100"});
	_FORTUNA_.push({texto:"Heradeste $100.", op:"+", num:"100"});
	_FORTUNA_.push({texto:"Error del banco a tu favor, cobraste $200.", op:"+", num:"200"});
	var _ARCA_ = new Array();
	var s1, s2, s3, s4, s5, s6;
	var _CANVGAME_ = document.getElementById("game");
	var _CTXGAME_ = _CANVGAME_.getContext("2d");
	var _GAMESTATUS_ = document.getElementById("game-state");
	_GAMESTATUS_.style.display = "none";
	var _BUSCANDORIVAL_;
	var _DADO1_ = new Image;
	var _DADO2_ = new Image;
	var _JUGADORAS_ = new Array();
	_JUGADORAS_.push({x:"600", y:"580", w:"30", h:"30", dinero:"1500", img: {}, casilla:"0", nombre: "JUGADOR 1"});
	_JUGADORAS_.push({x:"600", y:"610", w:"30", h:"25", dinero:"1500", img: {}, casilla:"0", nombre: "JUGADOR 2"});
	_JUGADORAS_[0].img = new Image;
	_JUGADORAS_[1].img = new Image;

	function online(){
		_GAMESTATUS_.innerHTML = "Buscando rival";
		clearInterval(_BUSCANDORIVAL_);
		var text = "Buscado rival";
		var flagpuntitos = 0;
		_BUSCANDORIVAL_ = setInterval(function(){
			text = "Buscando rival";
			_GAMESTATUS_.style.display = "block";
			if(flagpuntitos == 0){flagpuntitos++;}
			else if(flagpuntitos == 1){text += "."; flagpuntitos++;}
			else if(flagpuntitos == 2){text += ".."; flagpuntitos++;}
			else if(flagpuntitos == 3){text += "..."; flagpuntitos = 0;}
			_GAMESTATUS_.innerHTML = text;
		}, 500);
		startGameOnline();
	}

	function offline(){
		clearInterval(_BUSCANDORIVAL_);
		_GAMESTATUS_.style.display = "block";
		_GAMESTATUS_.innerHTML = "Juego en curso. Rival: Inteligencia artificial.";
		startGameOffline();
	}
</script>
<!-- ================================================ -->

<!-- ==================== GAME ====================== -->
<script type="text/javascript">
	var _CASAS_ = new Array();
	var _TURNO_ = 0;
	var _DADOS_ = 0;
	var _BOARD_ = new Array();
	var _VARIOSTURNOS_ = 0;
	for(var i = 0; i < 40; i++) _BOARD_.push({});
	var _PROPIEDADES_ = new Array();
	_PROPIEDADES_.push(new Array());
	_PROPIEDADES_.push(new Array());
	function flipBit(bit){
		if(bit == 0) return 1;
		else if(bit == 1) return 0;
	}

	function cambiaTurno(){
		if(_TURNO_ == 0) _TURNO_ = 1;
		else _TURNO_ = 0;
	}

	function deshabilita(nom, val){
		document.getElementById(nom).disabled = val;
		if(val) document.getElementById(nom).setAttribute("class", "disabled");
		else document.getElementById(nom).setAttribute("class", "comando");
	}

	function deshabilitaTodo(){
		deshabilita("tirardados0", true);
		deshabilita("comprarpropiedad0", true);
		deshabilita("colocarcasa0", true);
		deshabilita("colocarhotel0", true);
		deshabilita("vendercasa0", true);
		deshabilita("venderhotel0", true);
		deshabilita("venderpropiedad0", true);
		deshabilita("pasar0", true);
		deshabilita("tirardados1", true);
		deshabilita("comprarpropiedad1", true);
		deshabilita("colocarcasa1", true);
		deshabilita("colocarhotel1", true);
		deshabilita("vendercasa1", true);
		deshabilita("venderhotel1", true);
		deshabilita("venderpropiedad1", true);
		deshabilita("pasar1", true);
	}
	function isCambioTurno(){
		if(document.getElementById("tirardados"+_TURNO_).disabled == true &&
			document.getElementById("comprarpropiedad"+_TURNO_).disabled == true)
			return true;
		else return false;
	}
	function habilitaBotones(){
		var Casilla = _BOARD_[parseInt(_JUGADORAS_[_TURNO_].casilla)];
		var Jugadora = _JUGADORAS_[_TURNO_];
		if(_TURNO_ == 0){
			if(_VARIOSTURNOS_ == 0){
				deshabilita("tirardados0", true);
			}
			else{
				deshabilita("tirardados0", false);
			}
			if((parseInt(Casilla.precio) > parseInt(Jugadora.dinero)) || (Casilla.id == "arca") || (Casilla.id == "esquina") || (Casilla.id == "impuestos") || (Casilla.id == "fortuna") || (Casilla.duenio != "-1")){
				deshabilita("comprarpropiedad0", true);
			}
			else{
				deshabilita("comprarpropiedad0", false);
			}
			if(document.getElementById("comprarpropiedad0").disabled == false && document.getElementById("tirardados0").disabled == true){
				deshabilita("pasar0", false);
			}
			else{
				deshabilita("pasar0", true);
			}
			
			if(_PROPIEDADES_[0].length > 0){
				var e = document.getElementById("selectcolocar0");
				var estado = buscarEstadoPropiedad(e.options[e.selectedIndex].value);
				if(estado.id != "impuestos" && estado.id != "arca" && estado.id != "esquina" && estado.id != "servicio"){
					if(parseInt(estado.noCasas) == 4){
						deshabilita("colocarhotel0", false);
						deshabilita("colocarcasa0", true);
					}
					else{
						deshabilita("colocarcasa0", false);
						deshabilita("colocarhotel0", true);
					}
				}
				else{
					deshabilita("colocarcasa0", true);
					deshabilita("colocarhotel0", true);
				}

				e = document.getElementById("selectvendercasas0");
				estado = buscarEstadoPropiedad(e.options[e.selectedIndex].value);
				if(parseInt(estado.noCasas) > 0){
					if(parseInt(estado.noCasas) == 5){
						deshabilita("venderhotel0", false);
						deshabilita("vendercasa0", true);
					}
					else{
						deshabilita("vendercasa0", false);
						deshabilita("venderhotel0", true);
					}
				}
				else{
					deshabilita("vendercasa0", true);
					deshabilita("venderhotel0", true);
				}

				e = document.getElementById("selectvender0");
				estado = buscarEstadoPropiedad(e.options[e.selectedIndex].value);
				if(parseInt(estado.noCasas) == 0){
					deshabilita("venderpropiedad0", false);
				}
				else{
					deshabilita("venderpropiedad0", true);
				}
			}

			deshabilita("tirardados1", true);
			deshabilita("comprarpropiedad1", true);
		}
		else{
			deshabilita("tirardados0", true);
			deshabilita("comprarpropiedad0", true);
			if(_VARIOSTURNOS_ == 0){
				deshabilita("tirardados1", true);
			}
			else{
				deshabilita("tirardados1", false);
			}
			if((parseInt(Casilla.precio) > parseInt(Jugadora.dinero)) || (Casilla.id == "arca") || (Casilla.id == "esquina") || (Casilla.id == "impuestos") || (Casilla.id == "fortuna") || (Casilla.duenio != "-1")){
				deshabilita("comprarpropiedad1", true);
			}
			else{
				deshabilita("comprarpropiedad1", false);
			}
			if(document.getElementById("comprarpropiedad1").disabled == false && document.getElementById("tirardados1").disabled == true){
				deshabilita("pasar1", false);
			}
			else{
				deshabilita("pasar1", true);
			}
			if(_PROPIEDADES_[1].length > 0){
				var e = document.getElementById("selectcolocar1");
				var estado = buscarEstadoPropiedad(e.options[e.selectedIndex].value);
				if(estado.id != "impuestos" && estado.id != "arca" && estado.id != "esquina" && estado.id != "servicio"){
					if(parseInt(estado.noCasas) == 4){
						deshabilita("colocarhotel1", false);
						deshabilita("colocarcasa1", true);
					}
					else{
						deshabilita("colocarcasa1", false);
						deshabilita("colocarhotel1", true);
					}
				}
				else{
					deshabilita("colocarcasa1", true);
					deshabilita("colocarhotel1", true);
				}

				e = document.getElementById("selectvendercasas1");
				estado = buscarEstadoPropiedad(e.options[e.selectedIndex].value);
				if(parseInt(estado.noCasas) > 0){
					if(parseInt(estado.noCasas) == 5){
						deshabilita("venderhotel1", false);
						deshabilita("vendercasa1", true);
					}
					else{
						deshabilita("vendercasa1", false);
						deshabilita("venderhotel1", true);
					}
				}
				else{
					deshabilita("vendercasa1", true);
					deshabilita("venderhotel1", true);
				}

				e = document.getElementById("selectvender1");
				estado = buscarEstadoPropiedad(e.options[e.selectedIndex].value);
				if(parseInt(estado.noCasas) == 0){
					deshabilita("venderpropiedad1", false);
				}
				else{
					deshabilita("venderpropiedad1", true);
				}
			}
		}
	}
	function pasar(){
		deshabilita("pasar"+_TURNO_, true);
		cambiaTurno();
		_VARIOSTURNOS_ = 1;
		habilitaBotones();
		actualizaPrints();
	}

	function buscarEstadoPropiedad(nom){
		for(var it = 0; it < 40; it++)
			if(_BOARD_[it].nombre == nom)
				return _BOARD_[it];
		return 0;
	}

	function buscarIndexEstado(nom){
		for(var it = 0; it < 40; it++)
			if(_BOARD_[it].nombre == nom)
				return it;
		return 0;
	}

	function retornoSelect(nom, turno){
		var retorno = "<select id='"+nom+"'>";
		var estado, str="";
		for(var p = 0; p < _PROPIEDADES_[turno].length; p++){
			estado = buscarEstadoPropiedad(_PROPIEDADES_[turno][p]);
			if(estado.id == "cafe") str = "#a24501";
			else if(estado.id == "cyan") str = "#02c7b8";
			else if(estado.id == "morado") str = "#c7027f";
			else if(estado.id == "naranja") str = "#ff6c00";
			else if(estado.id == "rojo") str = "#ff0000";
			else if(estado.id == "amarillo") str = "#d6d600";
			else if(estado.id == "verde") str = "#03d600";
			else if(estado.id == "rey") str = "#0003d6";
			else str = "#000000";
			retorno += "<option style='color:"+str+";' value='"+_PROPIEDADES_[turno][p]+"'>"+_PROPIEDADES_[turno][p]+"</option>";
		}
		retorno += "</select>";
		return retorno;
	}

	function actualizaPrints(){
		var objeto;
		document.getElementById("player1-money").innerHTML = "DINERO: "+_JUGADORAS_[0].dinero+" <span class='monopolymoney inline-block'>&#8361;</span>";
		document.getElementById("player2-money").innerHTML = "DINERO: "+_JUGADORAS_[1].dinero+" <span class='monopolymoney inline-block'>&#8361;</span>";
		var texto = "Turno: "+_JUGADORAS_[_TURNO_].nombre;
		_CTXGAME_.clearRect(100, 525, 450, 20);
		_CTXGAME_.fillText(texto, 100, 540);
		_CTXGAME_.stroke();
		document.getElementById("propiedadescolocar0").innerHTML = retornoSelect("selectcolocar0", 0);
		document.getElementById("propiedadesvender0").innerHTML = retornoSelect("selectvendercasas0", 0);
		document.getElementById("propiedadvender0").innerHTML = retornoSelect("selectvender0", 0);
		document.getElementById("propiedadescolocar1").innerHTML = retornoSelect("selectcolocar1", 1);
		document.getElementById("propiedadesvender1").innerHTML = retornoSelect("selectvendercasas1", 1);
		document.getElementById("propiedadvender1").innerHTML = retornoSelect("selectvender1", 1);
		s1 = document.getElementById("selectcolocar0");
		s1.addEventListener("click", function() {
			var options = s1.querySelectorAll("option");
			var count = options.length;
			if(typeof(count) === "undefined" || count < 2){
				habilitaBotones();
			}
		});
		s1.addEventListener("change", function() {
			habilitaBotones();
		});
		s2 = document.getElementById("selectvendercasas0");
		s2.addEventListener("change", function() {
			habilitaBotones();
		});
		s3 = document.getElementById("selectvender0");
		s3.addEventListener("change", function() {
			habilitaBotones();
		});
		s4 = document.getElementById("selectcolocar1");
		s4.addEventListener("change", function() {
			habilitaBotones();
		});
		s5 = document.getElementById("selectvendercasas1");
		s5.addEventListener("change", function() {
			habilitaBotones();
		});
		s6 = document.getElementById("selectvender1");
		s6.addEventListener("change", function() {
			habilitaBotones();
		});
	}

	function startANewGame(){
		_JUGADORAS_[0].nombre = document.getElementById("player1-name").innerHTML;
		_JUGADORAS_[1].nombre = document.getElementById("player2-name").innerHTML;
		_JUGADORAS_[0].dinero = 1500;
		_JUGADORAS_[1].dinero = 1500;
		_BOARD_[0] = {id:"esquina", precio:"200", duenio:"-1", noCasas:"0", nombre:"inicio"};
		_BOARD_[1] = {id:"cafe", precio:"60", duenio:"-1", noCasas:"0", nombre:"MEDITERRANEAN AVENUE"};
		_BOARD_[2] = {id:"arca", precio:"0", duenio:"-1", noCasas:"0", nombre:"arca"};
		_BOARD_[3] = {id:"cafe", precio:"60", duenio:"-1", noCasas:"0", nombre:"BALTIC AVENUE"};
		_BOARD_[4] = {id:"impuestos", precio:"200", duenio:"-1", noCasas:"0", nombre:"impuestos"};
		_BOARD_[5] = {id:"tren", precio:"200", duenio:"-1", noCasas:"0", nombre:"READING RAILROAD"};
		_BOARD_[6] = {id:"cyan", precio:"100", duenio:"-1", noCasas:"0", nombre:"ORIENTAL AVENUE"};
		_BOARD_[7] = {id:"fortuna", precio:"0", duenio:"-1", noCasas:"0", nombre:"fortuna"};
		_BOARD_[8] = {id:"cyan", precio:"100", duenio:"-1", noCasas:"0", nombre:"VERMONT AVENUE "};
		_BOARD_[9] = {id:"cyan", precio:"120", duenio:"-1", noCasas:"0", nombre:"CONNECTICUT AVENUE"};
		_BOARD_[10] = {id:"esquina", precio:"0", duenio:"-1", noCasas:"0", nombre:"carcel"};
		_BOARD_[11] = {id:"morado", precio:"140", duenio:"-1", noCasas:"0", nombre:"ST. CHARLES PLACE"};
		_BOARD_[12] = {id:"servicio", precio:"150", duenio:"-1", noCasas:"0", nombre:"ELECTRIC COMPANY"};
		_BOARD_[13] = {id:"morado", precio:"140", duenio:"-1", noCasas:"0", nombre:"STATES AVENUE"};
		_BOARD_[14] = {id:"morado", precio:"160", duenio:"-1", noCasas:"0", nombre:"VIRGINIA AVENUE"};
		_BOARD_[15] = {id:"tren", precio:"200", duenio:"-1", noCasas:"0", nombre:"PENNSYLVANIA RAILROAD"};
		_BOARD_[16] = {id:"naranja", precio:"180", duenio:"-1", noCasas:"0", nombre:"ST. JAMES PLACES"};
		_BOARD_[17] = {id:"arca", precio:"0", duenio:"-1", noCasas:"0", nombre:"arca"};
		_BOARD_[18] = {id:"naranja", precio:"180", duenio:"-1", noCasas:"0", nombre:"TENNESSEE AVENUE"};
		_BOARD_[19] = {id:"naranja", precio:"200", duenio:"-1", noCasas:"0", nombre:"NEW YORK AVENUE"};
		_BOARD_[20] = {id:"esquina", precio:"0", duenio:"-1", noCasas:"0", nombre:"parada libre"};
		_BOARD_[21] = {id:"rojo", precio:"220", duenio:"-1", noCasas:"0", nombre:"KENTUCKY AVENUE"};
		_BOARD_[22] = {id:"fortuna", precio:"0", duenio:"-1", noCasas:"0", nombre:"fortuna"};
		_BOARD_[23] = {id:"rojo", precio:"220", duenio:"-1", noCasas:"0", nombre:"INDIANA AVENUE"};
		_BOARD_[24] = {id:"rojo", precio:"240", duenio:"-1", noCasas:"0", nombre:"ILLINOIS AVENUE"};
		_BOARD_[25] = {id:"tren", precio:"200", duenio:"-1", noCasas:"0", nombre:"B&O RAILROAD"};
		_BOARD_[26] = {id:"amarillo", precio:"260", duenio:"-1", noCasas:"0", nombre:"ATLANTIC AVENUE"};
		_BOARD_[27] = {id:"amarillo", precio:"260", duenio:"-1", noCasas:"0", nombre:"VENTINOR AVENUE"};
		_BOARD_[28] = {id:"servicio", precio:"150", duenio:"-1", noCasas:"0", nombre:"WATER WORKS"};
		_BOARD_[29] = {id:"amarillo", precio:"280", duenio:"-1", noCasas:"0", nombre:"MARVIN GARDENS"};
		_BOARD_[30] = {id:"esquina", precio:"0", duenio:"-1", noCasas:"0", nombre:"ir a carcel"};
		_BOARD_[31] = {id:"verde", precio:"300", duenio:"-1", noCasas:"0", nombre:"PACIFIC AVENUE"};
		_BOARD_[32] = {id:"verde", precio:"300", duenio:"-1", noCasas:"0", nombre:"NORTH CAROLINA AVENUE"};
		_BOARD_[33] = {id:"arca", precio:"0", duenio:"-1", noCasas:"0", nombre:"arca"};
		_BOARD_[34] = {id:"verde", precio:"320", duenio:"-1", noCasas:"0", nombre:"PENNSYLVANIA AVENUE"};
		_BOARD_[35] = {id:"tren", precio:"200", duenio:"-1", noCasas:"0", nombre:"SHORT LINE"};
		_BOARD_[36] = {id:"fortuna", precio:"0", duenio:"-1", noCasas:"0", nombre:"fortuna"};
		_BOARD_[37] = {id:"rey", precio:"350", duenio:"-1", noCasas:"0", nombre:"PARK PLACE"};
		_BOARD_[38] = {id:"impuestos", precio:"100", duenio:"-1", noCasas:"0", nombre:"impuestos"};
		_BOARD_[39] = {id:"rey", precio:"400", duenio:"-1", noCasas:"0", nombre:"BOARDWALK"};
		_DADO1_.src = "dado1.png";
		_DADO1_.onload = function(){
			_CTXGAME_.drawImage(_DADO1_, 250, 350, 50, 50);
			_CTXGAME_.stroke();
		}
		_DADO2_.src = "dado2.png";
		_DADO2_.onload = function(){
			_CTXGAME_.drawImage(_DADO2_, 300, 350, 50, 50);
			_CTXGAME_.stroke();
		}
		_JUGADORAS_[0].img.src = "jugador0.png";
		_JUGADORAS_[0].img.onload = function(){
			_CTXGAME_.drawImage(_JUGADORAS_[0].img, _JUGADORAS_[0].x, _JUGADORAS_[0].y, _JUGADORAS_[0].w, _JUGADORAS_[0].h);
			_CTXGAME_.stroke();
		}
		_JUGADORAS_[1].img.src = "jugador1.png";
		_JUGADORAS_[1].img.onload = function(){
			_CTXGAME_.drawImage(_JUGADORAS_[1].img, _JUGADORAS_[1].x, _JUGADORAS_[1].y, _JUGADORAS_[1].w, _JUGADORAS_[1].h);
			_CTXGAME_.stroke();
		}
		_CTXGAME_.font = "15px Arial";
		_VARIOSTURNOS_ = 1;
		habilitaBotones();
		_VARIOSTURNOS_ = 0;
		actualizaPrints();
	}

	function comprarPropiedad(){
		var Jugadora = _JUGADORAS_[_TURNO_];
		var Casilla = _BOARD_[parseInt(Jugadora.casilla)];
		Casilla.duenio = ""+_TURNO_;
		Jugadora.dinero = ""+(parseInt(Jugadora.dinero)-parseInt(Casilla.precio));
		_PROPIEDADES_[_TURNO_].push(Casilla.nombre);
		revisaEstado();
	}

	function colocarCasa(){

	}

	function buscarIndexPropiedad(nom, turno){
		for(var n = 0; n < _PROPIEDADES_[turno].length; n++){
			if(_PROPIEDADES_[turno][n] == nom){
				return n;
			}
		}
		return -1;
	}

	function venderPropiedad(turno){
		var e = document.getElementById("selectvender"+turno.toString());
		var estado = buscarIndexEstado(e.options[e.selectedIndex].value);
		var index = buscarIndexPropiedad(e.options[e.selectedIndex].value, turno);
		_BOARD_[estado].duenio = "-1";
		_PROPIEDADES_[turno].splice(index, 1);
		
		actualizaPrints();
		habilitaBotones();
	}

	function tirarDados(){
		var dadouno = Math.floor(Math.random() * 6) + 1;
		var dadodos = Math.floor(Math.random() * 6) + 1;
		if(dadouno == dadodos) _VARIOSTURNOS_++;
		else _VARIOSTURNOS_ = 0;
		_DADOS_ = dadouno+dadodos;
		_DADO1_.src = "dado"+dadouno+".png";
		_DADO1_.onload = function(){
			_CTXGAME_.drawImage(_DADO1_, 250, 350, 50, 50);
			_CTXGAME_.stroke();
		}

		_DADO2_.src = "dado"+dadodos+".png";
		_DADO2_.onload = function(){
			_CTXGAME_.drawImage(_DADO2_, 300, 350, 50, 50);
			_CTXGAME_.stroke();
		}
		moverPieza();
		deshabilitaTodo();
	}

	function isBancarrota(){
		return false;
	}

	function irALaCarcel(){

	}

	function pagarImpuestos(impuestos){
		alert("Pagaste "+impuestos+" de impuestos.");
		_JUGADORAS_[_TURNO_].dinero = (parseInt(_JUGADORAS_[_TURNO_].dinero) - impuestos);
	}

	function sacarFortuna(){
		var Jugadora = _JUGADORAS_[_TURNO_];
		var JugadoraEnemiga = _JUGADORAS_[flipBit(_TURNO_)];
		var randnum = Math.floor(Math.random() * 15);
		var Fortuna = _FORTUNA_[randnum];
		alert(Fortuna.texto);
		if(Fortuna.op == "+"){
			Jugadora.dinero = ""+(parseInt(Jugadora.dinero)+parseInt(Fortuna.num));
		}
		else if(Fortuna.op == "++"){
			Jugadora.dinero = ""+(parseInt(Jugadora.dinero)+parseInt(Fortuna.num));
			JugadoraEnemiga.dinero = ""+(parseInt(JugadoraEnemiga.dinero)-parseInt(Fortuna.num));
		}
		else if(Fortuna.op == "+++"){
			Jugadora.x = "600";
			Jugadora.y = "580";
			Jugadora.dinero = ""+(parseInt(Jugadora.dinero)+parseInt(Fortuna.num));
		}
		else if(Fortuna.op == "-"){
			Jugadora.dinero = ""+(parseInt(Jugadora.dinero)-parseInt(Fortuna.num));
		}
	}

	function sacarArca(){
		var Jugadora = _JUGADORAS_[_TURNO_];
		var JugadoraEnemiga = _JUGADORAS_[flipBit(_TURNO_)];
		var randnum = Math.floor(Math.random() * 15);
		var Arca = _FORTUNA_[randnum];
		alert(Arca.texto);
		if(Arca.op == "+"){
			Jugadora.dinero = ""+(parseInt(Jugadora.dinero)+parseInt(Arca.num));
		}
		else if(Arca.op == "++"){
			Jugadora.dinero = ""+(parseInt(Jugadora.dinero)+parseInt(Arca.num));
			JugadoraEnemiga.dinero = ""+(parseInt(JugadoraEnemiga.dinero)-parseInt(Arca.num));
		}
		else if(Arca.op == "+++"){
			Jugadora.x = "600";
			Jugadora.y = "580";
			Jugadora.dinero = ""+(parseInt(Jugadora.dinero)+parseInt(Arca.num));
		}
		else if(Arca.op == "-"){
			Jugadora.dinero = ""+(parseInt(Jugadora.dinero)-parseInt(Arca.num));
		}
	}

	function revisaEstado(){
		var Turno = isBancarrota();
		if(Turno != false){
			
		}
		else{
			var Casilla = _BOARD_[parseInt(_JUGADORAS_[_TURNO_].casilla)];
			if(Casilla.id == "fortuna")
				sacarFortuna();
			else if(Casilla.id == "arca")
				sacarArca();
			else if(Casilla.id == "impuestos")
				pagarImpuestos(parseInt(Casilla.precio));
			else if(Casilla.id != "arca" && Casilla.id != "esquina" && Casilla.id != "fortuna" && Casilla.id != "impuestos" && Casilla.duenio == "-1")
				document.getElementById("comprarpropiedad"+_TURNO_).value = "Comprar propiedad (-"+Casilla.precio+")";
			else if(Casilla.duenio == flipBit(_TURNO_).toString())
				alert("¡Caíste en una propiedad enemiga! Pagaste renta.");
			
			actualizaPrints();
			habilitaBotones();
			if(isCambioTurno()){
				cambiaTurno();
				_VARIOSTURNOS_ = 1;
				actualizaPrints();
				habilitaBotones();
			}
		}
	}

	function moverPieza(){
		var Jugadora = _JUGADORAS_[_TURNO_];
		var cas = parseInt(Jugadora.casilla);
		var loop;
		var loop2;
		var aux_x = parseInt(Jugadora.x);
		var aux_y = parseInt(Jugadora.y);
		var corte = 0;
		var iteracion = 10;
		loop2 = setInterval(function(){
			if(corte == _DADOS_){
				revisaEstado();
				clearInterval(loop2);
			}
		}, 500);
		loop = setInterval(function(){
			_CTXGAME_.clearRect(Jugadora.x, Jugadora.y, Jugadora.w, Jugadora.h);
			Jugadora.img.src = "jugador"+_TURNO_+".png";
			if(cas == 0){
				Jugadora.img.onload = function(){
					aux_x -= 85;
					Jugadora.x = aux_x.toString();
					_CTXGAME_.drawImage(Jugadora.img, Jugadora.x, Jugadora.y, Jugadora.w, Jugadora.h);
					_CTXGAME_.stroke();
				}
				cas++;
			}
			else if(cas > 0 && cas < 9){
				Jugadora.img.onload = function(){
					aux_x -= 52;
					Jugadora.x = aux_x.toString();
					_CTXGAME_.drawImage(Jugadora.img, Jugadora.x, Jugadora.y, Jugadora.w, Jugadora.h);
					_CTXGAME_.stroke();
				}
				cas++;
			}
			else if(cas == 9){
				Jugadora.img.onload = function(){
					if(_TURNO_ == 0){
						Jugadora.x = 40;
						aux_x = 40;
						Jugadora.y = 580;
						aux_y = 580;
					}
					else{
						Jugadora.x = 15;
						aux_x = 15;
						Jugadora.y = 610;
						aux_y = 610;
					}
					_CTXGAME_.drawImage(Jugadora.img, Jugadora.x, Jugadora.y, Jugadora.w, Jugadora.h);
					_CTXGAME_.stroke();
				}
				cas++;
			}
			else if(cas == 10){
				Jugadora.img.onload = function(){
					if(_TURNO_ == 0){
						Jugadora.y = 520;
						aux_y = 520;
					}
					else{
						Jugadora.y = 500;
						aux_y = 500;
					}
					_CTXGAME_.drawImage(Jugadora.img, Jugadora.x, Jugadora.y, Jugadora.w, Jugadora.h);
					_CTXGAME_.stroke();
				}
				cas++;
			}
			else if(cas > 10 && cas < 20){
				Jugadora.img.onload = function(){
					if(cas == 19){if(_TURNO_==0) aux_y -= 63; else aux_y -= 73;}
					else aux_y -= 51;
					Jugadora.y = aux_y.toString();
					_CTXGAME_.drawImage(Jugadora.img, Jugadora.x, Jugadora.y, Jugadora.w, Jugadora.h);
					_CTXGAME_.stroke();
				}
				cas++;
			}
			else if(cas == 20){
				Jugadora.img.onload = function(){
					aux_x += 65;
					Jugadora.x = aux_x.toString();
					_CTXGAME_.drawImage(Jugadora.img, Jugadora.x, Jugadora.y, Jugadora.w, Jugadora.h);
					_CTXGAME_.stroke();
				}
				cas++;
			}
			else if(cas > 20 && cas < 30){
				Jugadora.img.onload = function(){
					aux_x += 51;
					Jugadora.x = aux_x.toString();
					_CTXGAME_.drawImage(Jugadora.img, Jugadora.x, Jugadora.y, Jugadora.w, Jugadora.h);
					_CTXGAME_.stroke();
				}
				cas++;
			}
			else if(cas == 30){
				Jugadora.img.onload = function(){
					aux_y += 51;
					Jugadora.y = aux_y.toString();
					_CTXGAME_.drawImage(Jugadora.img, Jugadora.x, Jugadora.y, Jugadora.w, Jugadora.h);
					_CTXGAME_.stroke();
				}
				cas++;
			}
			else if(cas > 30 && cas < 39){
				Jugadora.img.onload = function(){
					aux_y += 51;
					Jugadora.y = aux_y.toString();
					_CTXGAME_.drawImage(Jugadora.img, Jugadora.x, Jugadora.y, Jugadora.w, Jugadora.h);
					_CTXGAME_.stroke();
				}
				cas++;
			}
			else{
				if(_TURNO_ == 0){
					Jugadora.img.onload = function(){
						Jugadora.x = "600";
						Jugadora.y = "580";
						aux_x = parseInt(Jugadora.x);
						aux_y = parseInt(Jugadora.y);
						_CTXGAME_.drawImage(Jugadora.img, Jugadora.x, Jugadora.y, Jugadora.w, Jugadora.h);
						_CTXGAME_.stroke();
					}
				}
				else{
					Jugadora.img.onload = function(){
						Jugadora.x = "600";
						Jugadora.y = "610";
						aux_x = parseInt(Jugadora.x);
						aux_y = parseInt(Jugadora.y);
						Jugadora.y = aux_y.toString();
						_CTXGAME_.drawImage(Jugadora.img, Jugadora.x, Jugadora.y, Jugadora.w, Jugadora.h);
						_CTXGAME_.stroke();
					}
				}
				cas = 0;
			}
			corte++;
			Jugadora.casilla = cas.toString();
			if(corte == _DADOS_) clearInterval(loop);
		}, 500);
	}

	function startGameOffline(){
		document.getElementById("tirardados1").style.display = "none";
		document.getElementById("comprarpropiedad1").style.display = "none";
		document.getElementById("colocarcasa1").style.display = "none";
		document.getElementById("player1-name").innerHTML = document.getElementById("nick").value;
		document.getElementById("player2-name").innerHTML = "Inteligencia Artificial";
		startANewGame();
	}

	function startGameOnline(){
		document.getElementById("player1-name").innerHTML = document.getElementById("nick").value;
		startANewGame();
	}

	deshabilitaTodo();
</script>
<!-- ================================================ -->

<!-- =================== ONLINE ===================== -->
<script type="application/javascript">

</script>
<!-- ================================================ -->

<!-- ===================== IA ======================= -->
<script type="text/javascript">
	var _TURNOSIMULADO_ = _TURNO_;
</script>
<!-- ================================================ -->
